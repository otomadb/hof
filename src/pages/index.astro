---
import NormalLayout from "../layouts/Default.astro";
import type { ComponentProps } from "astro/types";
// import data from "../data/10sen.json";
// biome-ignore lint/style/useImportType: <explanation>
import TopSlides from "../components/TopSlides.astro";
import getThumbnail from "../components/getThumbnail";
import fetch10sen from "../data/fetch10sen";

const data = await fetch10sen();

const ten: ComponentProps<typeof TopSlides>[] = await Promise.all(
  Object.entries(data)
    .toReversed()
    .map(async ([year, values]) => {
      return {
        href: `/10sen/${year}`,
        title: `音MAD作者が選ぶ${year}年の音MAD10選`,
        c: await Promise.all(
          values.slice(0, 8).map(async ({ title, url, type }) => ({
            title,
            thumbnail: await getThumbnail(type, url),
          })),
        ),
      };
    }),
);
---


<NormalLayout title="音MAD HoF">
  <p class="text-slate-900 mb-4 text-center">このサイトでは何らかの形で殿堂入りした音MADのリストをまとめています。</p>
  <div class="flex flex-col gap-y-8">
    {
      ten.map((props) => (
        <TopSlides {...props} />
      ))
    }
  </div>
</NormalLayout>
